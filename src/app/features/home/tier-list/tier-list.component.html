@if (albumList && albumList.tieredAlbums) {
<div class="w-full h-full border border-slate-200 dark:border-zinc-700 rounded-lg overflow-hidden">
    @for (tier of (albumList.tieredAlbums | keyvalue: sortByTier); track tier.key) {
    <div class="flex bg-white dark:bg-zinc-900 w-full h-20 sm:h-30 md:h-40 lg:h-50">
        <div
            class="font-bold aspect-square text-4xl sm:text-5xl md:text-6xl lg:text-7xl text-slate-700 dark:text-white flex justify-center items-center">
            {{ tier.key }}
        </div>

        <div class="flex items-center">
            <div class="w-px bg-slate-300 dark:bg-zinc-600 h-3/4"></div>
        </div>

        @if (tier.value?.length){
        <p-carousel [value]="tier.value || []" [numVisible]="6" [numScroll]="6" [circular]="false"
            [showIndicators]="false" [responsiveOptions]="responsiveOptions" class="w-full h-full">

            <ng-template pTemplate="item" let-album>
                <div class="flex h-20 sm:h-30 md:h-40 lg:h-50 items-center justify-center">
                    <img [src]="album.thumbnailLarge" alt="Album Thumbnail" (click)="openAlbumDialog(album, tier.key)"
                        class="shadow-lg h-10 sm:h-20 md:h-30 lg:h-40 aspect-square object-cover rounded-lg transition-transform duration-200 hover:scale-110 hover:brightness-75 cursor-pointer" />
                </div>
            </ng-template>

        </p-carousel>
        }
    </div>

    <div class="flex justify-center">
        <div class="h-px bg-slate-300 dark:bg-zinc-600 w-full"></div>
    </div>
    }
</div>
} @else {
<div class="card flex justify-center">
    <p-progress-spinner strokeWidth="5" fill="transparent" [dt]="progressspinner" animationDuration="5s"
        [style]="{ width: '50px', height: '50px' }" />
</div>
}



<p-dialog [(visible)]="albumDialogVisible" [modal]="true" draggable="false" [closable]="true" focusOnShow="false"
    [dismissableMask]="true" [style]="{width: '50vw'}" [breakpoints]="{ '1024px': '50vw', '640px': '75vw' }"
    (onHide)="closeDialog()">

    <ng-template pTemplate="header">
        <div class="font-bold text-xl sm:text-2xl md:text-3xl">
            <span>{{ selectedTier ? selectedTier + ' Tier' : '' }}</span>
        </div>
    </ng-template>

    @if (selectedAlbum){

    <div class="flex gap-2 lg:gap-4 flex-col lg:flex-row">

        <div class="w-full lg:w-1/2">
            <img [src]="selectedAlbum.thumbnailLarge" class="w-full aspect-square object-cover rounded-lg" />
        </div>

        <div class="flex gap-2 w-full lg:w-1/2 flex-col overflow-hidden">
            <span class="text-lg sm:text-xl md:text-2xl font-bold break-words text-wrap underline">{{
                selectedAlbum.title }}</span>
            <span class="text-base sm:text-lg md:text-xl font-bold break-words text-wrap">Artist: {{
                selectedAlbum.artist }}</span>
            <span class="text-base sm:text-lg md:text-xl font-bold break-words text-wrap">Released: {{
                selectedAlbum.release | date:'dd MMMM yyyy'
                }}</span>
            <span class="text-base sm:text-lg md:text-xl font-bold break-words text-wrap">Genres: {{
                formatAlbumGenres(selectedAlbum.genres) || '-' }}</span>

            <div class="size-max flex flex-col gap-2 lg:gap-4">
                <a href={{selectedAlbum.spotifyLink}} pButton severity="success" target="_blank">
                    <svg height="20" width="20" viewBox="0 0 640 640">
                        <path [attr.fill]="isDarkMode ? '#052e16' : '#ffffff'"
                            d="M320 72C183 72 72 183 72 320C72 457 183 568 320 568C457 568 568 457 568 320C568 183 457 72 320 72zM420.7 436.9C416.5 436.9 413.9 435.6 410 433.3C347.6 395.7 275 394.1 203.3 408.8C199.4 409.8 194.3 411.4 191.4 411.4C181.7 411.4 175.6 403.7 175.6 395.6C175.6 385.3 181.7 380.4 189.2 378.8C271.1 360.7 354.8 362.3 426.2 405C432.3 408.9 435.9 412.4 435.9 421.5C435.9 430.6 428.8 436.9 420.7 436.9zM447.6 371.3C442.4 371.3 438.9 369 435.3 367.1C372.8 330.1 279.6 315.2 196.7 337.7C191.9 339 189.3 340.3 184.8 340.3C174.1 340.3 165.4 331.6 165.4 320.9C165.4 310.2 170.6 303.1 180.9 300.2C208.7 292.4 237.1 286.6 278.7 286.6C343.6 286.6 406.3 302.7 455.7 332.1C463.8 336.9 467 343.1 467 351.8C466.9 362.6 458.5 371.3 447.6 371.3zM478.6 295.1C473.4 295.1 470.2 293.8 465.7 291.2C394.5 248.7 267.2 238.5 184.8 261.5C181.2 262.5 176.7 264.1 171.9 264.1C158.7 264.1 148.6 253.8 148.6 240.5C148.6 226.9 157 219.2 166 216.6C201.2 206.3 240.6 201.4 283.5 201.4C356.5 201.4 433 216.6 488.9 249.2C496.7 253.7 501.8 259.9 501.8 271.8C501.8 285.4 490.8 295.1 478.6 295.1z" />
                    </svg>
                    <span pButtonLabel class="text-sm">Open in Spotify</span>
                </a>
                <a href={{selectedAlbum.youtubeLink}} pButton severity="danger" target="_blank">
                    <span pButtonIcon class="pi pi-youtube"></span>
                    <span pButtonLabel class="text-sm">Open in YouTube Music</span>
                </a>
            </div>
        </div>

    </div>
    }@else {
    <div class="flex justify-center items-center h-full">
        <p-progress-spinner strokeWidth="3" fill="transparent" [dt]="progressspinner" animationDuration="5s"
            [style]="{ width: '50px', height: '50px' }" />
    </div>
    }
</p-dialog>